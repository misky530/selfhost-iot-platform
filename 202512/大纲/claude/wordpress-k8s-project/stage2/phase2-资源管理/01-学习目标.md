å¤ªå¥½äº†ï¼ç°åœ¨å¼€å§‹**é˜¶æ®µ 2ï¼šèµ„æºç®¡ç†ï¼ˆResources Managementï¼‰**

---

## ğŸ“‹ é˜¶æ®µ 2 å­¦ä¹ ç›®æ ‡

### **æ ¸å¿ƒæ¦‚å¿µ**
1. **Resources Requests**ï¼šPod è°ƒåº¦æ—¶çš„èµ„æº"é¢„è®¢"
2. **Resources Limits**ï¼šPod è¿è¡Œæ—¶çš„èµ„æº"ä¸Šé™"
3. **QoSï¼ˆæœåŠ¡è´¨é‡ç­‰çº§ï¼‰**ï¼šæ ¹æ®èµ„æºé…ç½®è‡ªåŠ¨åˆ†ç±»
4. **OOMKilled**ï¼šå†…å­˜è¶…é™çš„å¤„ç†
5. **CPU Throttling**ï¼šCPU é™æµæœºåˆ¶

---

## ğŸ“ ç†è®ºåŸºç¡€

### **1. Requests vs Limits**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         èµ„æºä½¿ç”¨ç¤ºæ„å›¾               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Limit â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 1000m CPU    â”‚ â† ç¡¬ä¸Šé™ï¼ˆè¶…å‡ºä¼šè¢«é™æµï¼‰
â”‚         â–²                           â”‚
â”‚         â”‚ å®é™…ä½¿ç”¨å¯ä»¥æµ®åŠ¨          â”‚
â”‚         â–¼                           â”‚
â”‚  Request â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 500m CPU     â”‚ â† è°ƒåº¦ä¿è¯ï¼ˆèŠ‚ç‚¹å¿…é¡»æœ‰ï¼‰
â”‚                                     â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚
â”‚  0                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Requestï¼ˆè¯·æ±‚ï¼‰**ï¼š
- è°ƒåº¦å™¨ä¿è¯ï¼šèŠ‚ç‚¹å¿…é¡»æœ‰è¶³å¤Ÿçš„**å¯ç”¨èµ„æº**
- ç”¨é€”ï¼šé˜²æ­¢èµ„æºè¿‡åº¦åˆ†é…ï¼ˆovercommitï¼‰
- å½±å“ï¼šPod è°ƒåº¦ä½ç½®

**Limitï¼ˆé™åˆ¶ï¼‰**ï¼š
- Kubelet å¼ºåˆ¶æ‰§è¡Œï¼šå®¹å™¨**ä¸èƒ½è¶…è¿‡**æ­¤å€¼
- CPUï¼šè¶…å‡ºä¼šè¢«é™æµï¼ˆthrottlingï¼‰ï¼Œä¸ä¼šè¢«æ€
- Memoryï¼šè¶…å‡ºä¼šè¢«æ€æ‰ï¼ˆOOMKilledï¼‰

---

### **2. QoS ç­‰çº§ï¼ˆè‡ªåŠ¨åˆ†ç±»ï¼‰**

Kubernetes æ ¹æ®èµ„æºé…ç½®è‡ªåŠ¨ç»™ Pod åˆ†é… QoS ç­‰çº§ï¼š

| QoS ç­‰çº§ | æ¡ä»¶ | èµ„æºå›æ”¶ä¼˜å…ˆçº§ |
|---------|------|---------------|
| **Guaranteed** | æ‰€æœ‰å®¹å™¨éƒ½è®¾ç½® requests = limits | ğŸ›¡ï¸ æœ€ä½ï¼ˆæœ€åè¢«é©±é€ï¼‰ |
| **Burstable** | è‡³å°‘ä¸€ä¸ªå®¹å™¨è®¾ç½®äº† requests æˆ– limits | âš ï¸ ä¸­ç­‰ |
| **BestEffort** | æ²¡æœ‰ä»»ä½•å®¹å™¨è®¾ç½® requests/limits | âš¡ æœ€é«˜ï¼ˆæœ€å…ˆè¢«é©±é€ï¼‰ |

**èµ„æºä¸è¶³æ—¶çš„é©±é€é¡ºåº**ï¼š
```
BestEffort â†’ Burstableï¼ˆè¶…å‡º request çš„ï¼‰ â†’ Guaranteed
```

---

### **3. CPU å•ä½è¯´æ˜**

```
1 CPU = 1000 millicores (m)

å¸¸è§å†™æ³•ï¼š
- 1000m = 1 CPU = 1 core
- 500m  = 0.5 CPU = åŠä¸ªæ ¸å¿ƒ
- 100m  = 0.1 CPU = 1/10 æ ¸å¿ƒ
```

**æ¨èé…ç½®**ï¼š
- **Web åº”ç”¨**ï¼šrequest 100-200mï¼Œlimit 500-1000m
- **æ•°æ®åº“**ï¼šrequest 500m-1ï¼Œlimit 2-4

---

### **4. Memory å•ä½è¯´æ˜**

```
å¸¸è§å•ä½ï¼š
- 128Mi = 128 Mebibytes (äºŒè¿›åˆ¶)
- 128M  = 128 Megabytes (åè¿›åˆ¶)

æ¨èç”¨ Mi/Giï¼ˆæ›´ç²¾ç¡®ï¼‰

1Gi = 1024Mi
1Mi = 1024Ki
```

**æ¨èé…ç½®**ï¼š
- **WordPress**ï¼šrequest 256Miï¼Œlimit 512Mi
- **MySQL**ï¼šrequest 512Miï¼Œlimit 1Gi

---

## ğŸ“ é…ç½®æ–‡ä»¶ï¼šv2.1-wordpress-with-resources.yaml

åˆ›å»ºæ–°ç‰ˆæœ¬é…ç½®ï¼š

```yaml
# ==================================================
# WordPress v2.1 - æ·»åŠ èµ„æºç®¡ç†
# å­¦ä¹ ç›®æ ‡ï¼šç†è§£ Requests/Limits å’Œ QoS
# ==================================================
apiVersion: v1
kind: Namespace
metadata:
  name: wordpress-v2
  labels:
    version: "2.1"
---
# MySQL Secretï¼ˆä¸ v2.0 ç›¸åŒï¼‰
apiVersion: v1
kind: Secret
metadata:
  name: mysql-secret
  namespace: wordpress-v2
type: Opaque
data:
  mysql-root-password: TXlSMDB0UEBzcw==
  mysql-password: V1BQQHNzdzByZA==
---
# MySQL PVC
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: mysql-pvc
  namespace: wordpress-v2
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: local-path
  resources:
    requests:
      storage: 5Gi
---
# MySQL Deployment
apiVersion: apps/v1
kind: Deployment
metadata:
  name: mysql
  namespace: wordpress-v2
spec:
  replicas: 1
  selector:
    matchLabels:
      app: mysql
  template:
    metadata:
      labels:
        app: mysql
    spec:
      containers:
      - name: mysql
        image: mysql:8.0
        env:
        - name: MYSQL_ROOT_PASSWORD
          valueFrom:
            secretKeyRef:
              name: mysql-secret
              key: mysql-root-password
        - name: MYSQL_DATABASE
          value: wordpress
        - name: MYSQL_USER
          value: wpuser
        - name: MYSQL_PASSWORD
          valueFrom:
            secretKeyRef:
              name: mysql-secret
              key: mysql-password
        ports:
        - containerPort: 3306
          name: mysql
        volumeMounts:
        - name: mysql-storage
          mountPath: /var/lib/mysql
        # ===== å¥åº·æ£€æŸ¥ï¼ˆv2.0 å·²æœ‰ï¼‰=====
        livenessProbe:
          exec:
            command:
            - mysqladmin
            - ping
            - -h
            - localhost
          initialDelaySeconds: 30
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
        readinessProbe:
          exec:
            command:
            - mysqladmin
            - ping
            - -h
            - localhost
          initialDelaySeconds: 10
          periodSeconds: 5
          timeoutSeconds: 3
          failureThreshold: 3
        # ===== æ–°å¢ï¼šMySQL èµ„æºé…ç½® =====
        resources:
          requests:
            # CPU è¯·æ±‚ï¼š500m = 0.5 æ ¸å¿ƒ
            # è°ƒåº¦æ—¶ä¿è¯èŠ‚ç‚¹æœ‰ 0.5 æ ¸å¯ç”¨
            cpu: 500m
            # Memory è¯·æ±‚ï¼š512Mi
            # è°ƒåº¦æ—¶ä¿è¯èŠ‚ç‚¹æœ‰ 512Mi å¯ç”¨
            memory: 512Mi
          limits:
            # CPU é™åˆ¶ï¼š1 æ ¸å¿ƒ
            # è¶…å‡ºä¼šè¢«é™æµï¼Œä½†ä¸ä¼šè¢«æ€
            cpu: 1000m
            # Memory é™åˆ¶ï¼š1Gi
            # è¶…å‡ºä¼šè¢« OOMKilledï¼ˆé‡è¦ï¼ï¼‰
            memory: 1Gi
      volumes:
      - name: mysql-storage
        persistentVolumeClaim:
          claimName: mysql-pvc
---
# MySQL Service
apiVersion: v1
kind: Service
metadata:
  name: mysql
  namespace: wordpress-v2
spec:
  selector:
    app: mysql
  ports:
  - port: 3306
    targetPort: 3306
  clusterIP: None
---
# WordPress PVC
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: wordpress-pvc
  namespace: wordpress-v2
spec:
  accessModes:
    - ReadWriteOnce
  storageClassName: local-path
  resources:
    requests:
      storage: 5Gi
---
# WordPress Deployment
apiVersion: apps/v1
kind: Deployment
metadata:
  name: wordpress
  namespace: wordpress-v2
spec:
  replicas: 1
  selector:
    matchLabels:
      app: wordpress
  template:
    metadata:
      labels:
        app: wordpress
    spec:
      containers:
      - name: wordpress
        image: wordpress:6.2-apache
        env:
        - name: WORDPRESS_DB_HOST
          value: mysql:3306
        - name: WORDPRESS_DB_USER
          value: wpuser
        - name: WORDPRESS_DB_PASSWORD
          valueFrom:
            secretKeyRef:
              name: mysql-secret
              key: mysql-password
        - name: WORDPRESS_DB_NAME
          value: wordpress
        ports:
        - containerPort: 80
          name: http
        volumeMounts:
        - name: wordpress-storage
          mountPath: /var/www/html
        # ===== å¥åº·æ£€æŸ¥ï¼ˆv2.0 å·²æœ‰ï¼‰=====
        livenessProbe:
          httpGet:
            path: /wp-admin/install.php
            port: 80
            httpHeaders:
            - name: Host
              value: localhost
          initialDelaySeconds: 60
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /wp-login.php
            port: 80
            httpHeaders:
            - name: Host
              value: localhost
          initialDelaySeconds: 30
          periodSeconds: 5
          timeoutSeconds: 3
          failureThreshold: 3
        # ===== æ–°å¢ï¼šWordPress èµ„æºé…ç½® =====
        resources:
          requests:
            # CPU è¯·æ±‚ï¼š200m = 0.2 æ ¸å¿ƒ
            # WordPress æ˜¯ Web åº”ç”¨ï¼ŒCPU éœ€æ±‚è¾ƒä½
            cpu: 200m
            # Memory è¯·æ±‚ï¼š256Mi
            # PHP + Apache åŸºç¡€å†…å­˜
            memory: 256Mi
          limits:
            # CPU é™åˆ¶ï¼š500m = 0.5 æ ¸å¿ƒ
            # é«˜å³°æœŸå¯ç”¨ 0.5 æ ¸
            cpu: 500m
            # Memory é™åˆ¶ï¼š512Mi
            # é˜²æ­¢å†…å­˜æ³„æ¼å¯¼è‡´èŠ‚ç‚¹é—®é¢˜
            memory: 512Mi
      volumes:
      - name: wordpress-storage
        persistentVolumeClaim:
          claimName: wordpress-pvc
---
# WordPress Service
apiVersion: v1
kind: Service
metadata:
  name: wordpress
  namespace: wordpress-v2
spec:
  type: NodePort
  selector:
    app: wordpress
  ports:
  - port: 80
    targetPort: 80
    nodePort: 30081
```

---

## ğŸš€ éƒ¨ç½²å’ŒéªŒè¯

### **æ­¥éª¤ 1ï¼šåº”ç”¨é…ç½®**

```bash
# åº”ç”¨æ–°é…ç½®ï¼ˆä¼šæ›´æ–°ç°æœ‰ Deploymentï¼‰
kubectl apply -f v2.1-wordpress-with-resources.yaml

# è§‚å¯Ÿ Pod é‡å»ºï¼ˆå› ä¸ºèµ„æºé…ç½®å˜åŒ–ï¼‰
kubectl get pods -n wordpress-v2 -w
```

---

### **æ­¥éª¤ 2ï¼šéªŒè¯èµ„æºé…ç½®**

```bash
# æŸ¥çœ‹ WordPress Pod çš„èµ„æºé…ç½®
kubectl describe pod -n wordpress-v2 -l app=wordpress | grep -A 10 "Requests\|Limits"
```

**é¢„æœŸè¾“å‡º**ï¼š
```
    Limits:
      cpu:     500m
      memory:  512Mi
    Requests:
      cpu:        200m
      memory:     256Mi
```

```bash
# æŸ¥çœ‹ MySQL Pod çš„èµ„æºé…ç½®
kubectl describe pod -n wordpress-v2 -l app=mysql | grep -A 10 "Requests\|Limits"
```

**é¢„æœŸè¾“å‡º**ï¼š
```
    Limits:
      cpu:     1
      memory:  1Gi
    Requests:
      cpu:        500m
      memory:     512Mi
```

---

### **æ­¥éª¤ 3ï¼šæ£€æŸ¥ QoS ç­‰çº§**

```bash
# æŸ¥çœ‹ WordPress Pod çš„ QoS ç­‰çº§
kubectl get pod -n wordpress-v2 -l app=wordpress -o jsonpath='{.items[0].status.qosClass}'
echo ""

# æŸ¥çœ‹ MySQL Pod çš„ QoS ç­‰çº§
kubectl get pod -n wordpress-v2 -l app=mysql -o jsonpath='{.items[0].status.qosClass}'
echo ""
```

**é¢„æœŸè¾“å‡º**ï¼š
```
Burstable  # WordPress (requests â‰  limits)
Burstable  # MySQL (requests â‰  limits)
```

---

### **æ­¥éª¤ 4ï¼šæŸ¥çœ‹èŠ‚ç‚¹èµ„æºåˆ†é…æƒ…å†µ**

```bash
# æŸ¥çœ‹èŠ‚ç‚¹èµ„æºä½¿ç”¨ï¼ˆé‡ç‚¹çœ‹ Allocated resourcesï¼‰
kubectl describe node k8s-master | grep -A 15 "Allocated resources"
```

**é¢„æœŸè¾“å‡º**ï¼š
```
Allocated resources:
  Resource           Requests      Limits
  --------           --------      ------
  cpu                700m (17%)    1500m (37%)    # WordPress 200m + MySQL 500m
  memory             768Mi (19%)   1536Mi (38%)   # WordPress 256Mi + MySQL 512Mi
```

---

## ğŸ§ª å®éªŒï¼šèµ„æºé™åˆ¶æµ‹è¯•

### **å®éªŒ 1ï¼šè§‚å¯Ÿ CPU å®é™…ä½¿ç”¨**

```bash
# å®‰è£… metrics-serverï¼ˆå¦‚æœè¿˜æ²¡å®‰è£…ï¼‰
# æˆ‘ä»¬åœ¨é˜¶æ®µ 5 ä¼šè¯¦ç»†é…ç½®ï¼Œè¿™é‡Œå…ˆè·³è¿‡
# kubectl top å‘½ä»¤éœ€è¦ metrics-server

# æ‰‹åŠ¨æŸ¥çœ‹å®¹å™¨ CPU ä½¿ç”¨ï¼ˆè¿›å…¥èŠ‚ç‚¹ï¼‰
# æ‰¾åˆ° WordPress Pod æ‰€åœ¨èŠ‚ç‚¹
NODE=$(kubectl get pod -n wordpress-v2 -l app=wordpress -o jsonpath='{.items[0].spec.nodeName}')
echo "WordPress Pod åœ¨èŠ‚ç‚¹: $NODE"

# æŸ¥çœ‹ Pod èµ„æºä½¿ç”¨ï¼ˆå¦‚æœæœ‰ metrics-serverï¼‰
# kubectl top pod -n wordpress-v2
```

---

### **å®éªŒ 2ï¼šæ¨¡æ‹Ÿ Memory Limit è¶…é™ï¼ˆå±é™©æ“ä½œï¼Œè°¨æ…ï¼‰**

âš ï¸ **è­¦å‘Š**ï¼šæ­¤å®éªŒä¼šå¯¼è‡´ Pod è¢«æ€ï¼Œæ•°æ®å¯èƒ½ä¸¢å¤±

```bash
# åˆ›å»ºä¸€ä¸ªæµ‹è¯• Pod éªŒè¯å†…å­˜é™åˆ¶
cat <<EOF | kubectl apply -f -
apiVersion: v1
kind: Pod
metadata:
  name: memory-test
  namespace: wordpress-v2
spec:
  containers:
  - name: stress
    image: polinux/stress
    command: ["stress"]
    args: ["--vm", "1", "--vm-bytes", "600M", "--vm-hang", "1"]
    resources:
      requests:
        memory: 256Mi
      limits:
        memory: 512Mi  # â† é™åˆ¶ 512Miï¼Œä½†å°è¯•ä½¿ç”¨ 600M
EOF

# è§‚å¯Ÿ Pod çŠ¶æ€ï¼ˆä¼šè¢« OOMKilledï¼‰
kubectl get pod -n wordpress-v2 memory-test -w

# æŸ¥çœ‹äº‹ä»¶
kubectl describe pod -n wordpress-v2 memory-test | tail -10
```

**é¢„æœŸè¾“å‡º**ï¼š
```
Status: OOMKilled
Reason: Memory limit exceeded
```

```bash
# æ¸…ç†æµ‹è¯• Pod
kubectl delete pod -n wordpress-v2 memory-test
```

---

## ğŸ”¬ æ·±å…¥ç†è§£ï¼šä¸åŒ QoS ç­‰çº§

### **åˆ›å»ºå¯¹æ¯”æµ‹è¯•**

```bash
cat <<'EOF' > qos-comparison.yaml
# ===== 1. Guaranteed QoS =====
apiVersion: v1
kind: Pod
metadata:
  name: qos-guaranteed
  namespace: wordpress-v2
spec:
  containers:
  - name: nginx
    image: nginx:alpine
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 100m      # â† requests = limits
        memory: 128Mi  # â† requests = limits
---
# ===== 2. Burstable QoS =====
apiVersion: v1
kind: Pod
metadata:
  name: qos-burstable
  namespace: wordpress-v2
spec:
  containers:
  - name: nginx
    image: nginx:alpine
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 200m      # â† requests < limits
        memory: 256Mi  # â† requests < limits
---
# ===== 3. BestEffort QoS =====
apiVersion: v1
kind: Pod
metadata:
  name: qos-besteffort
  namespace: wordpress-v2
spec:
  containers:
  - name: nginx
    image: nginx:alpine
    # â† æ²¡æœ‰ä»»ä½• resources é…ç½®
EOF

# åº”ç”¨æµ‹è¯• Pod
kubectl apply -f qos-comparison.yaml

# ç­‰å¾… Pod è¿è¡Œ
kubectl wait --for=condition=Ready pod -n wordpress-v2 -l '' --timeout=60s

# æŸ¥çœ‹ä¸‰ä¸ª Pod çš„ QoS ç­‰çº§
echo "=== QoS ç­‰çº§å¯¹æ¯” ==="
for pod in qos-guaranteed qos-burstable qos-besteffort; do
  qos=$(kubectl get pod -n wordpress-v2 $pod -o jsonpath='{.status.qosClass}')
  echo "$pod: $qos"
done
```

**é¢„æœŸè¾“å‡º**ï¼š
```
=== QoS ç­‰çº§å¯¹æ¯” ===
qos-guaranteed: Guaranteed
qos-burstable: Burstable
qos-besteffort: BestEffort
```

```bash
# æ¸…ç†æµ‹è¯• Pod
kubectl delete -f qos-comparison.yaml
```

---

## ğŸ“Š èµ„æºé…ç½®æœ€ä½³å®è·µ

### **1. æ¨èé…ç½®ç­–ç•¥**

| åº”ç”¨ç±»å‹ | CPU Request | CPU Limit | Memory Request | Memory Limit | QoS |
|---------|------------|-----------|----------------|--------------|-----|
| **Web å‰ç«¯** | 100-200m | 500m-1 | 128-256Mi | 256-512Mi | Burstable |
| **åº”ç”¨åç«¯** | 200-500m | 1-2 | 256-512Mi | 512Mi-1Gi | Burstable |
| **æ•°æ®åº“** | 500m-1 | 2-4 | 512Mi-1Gi | 1-2Gi | Burstable |
| **å…³é”®æœåŠ¡** | 500m | 500m | 512Mi | 512Mi | Guaranteed |

### **2. é…ç½®åŸåˆ™**

```yaml
# âœ… æ¨èï¼šBurstableï¼ˆå¯å¼¹æ€§æ‰©å±•ï¼‰
resources:
  requests:
    cpu: 200m      # ä¿è¯åŸºç¡€æ€§èƒ½
    memory: 256Mi
  limits:
    cpu: 500m      # é«˜å³°æœŸå¯ç”¨ 2.5 å€ CPU
    memory: 512Mi  # å†…å­˜ä¸Šé™ 2 å€

# âš ï¸ è°¨æ…ï¼šGuaranteedï¼ˆèµ„æºå›ºå®šï¼‰
resources:
  requests:
    cpu: 500m
    memory: 512Mi
  limits:
    cpu: 500m      # æ— æ³•å¼¹æ€§æ‰©å±•
    memory: 512Mi

# âŒ ä¸æ¨èï¼šBestEffortï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
# æ—  resources é…ç½®
# èµ„æºä¸è¶³æ—¶ä¼˜å…ˆè¢«é©±é€
```

### **3. å†…å­˜ vs CPU çš„å·®å¼‚**

| èµ„æºç±»å‹ | è¶…å‡º Limit è¡Œä¸º | æ˜¯å¦å¯å‹ç¼© | å½±å“ |
|---------|----------------|-----------|------|
| **CPU** | è¢«é™æµï¼ˆthrottlingï¼‰ | âœ… å¯å‹ç¼© | æ€§èƒ½ä¸‹é™ï¼ŒPod ä¸ä¼šè¢«æ€ |
| **Memory** | è¢«æ€ï¼ˆOOMKilledï¼‰ | âŒ ä¸å¯å‹ç¼© | Pod é‡å¯ï¼Œå¯èƒ½ä¸¢æ•°æ® |

**é…ç½®å»ºè®®**ï¼š
- **CPU Limit**ï¼šå¯ä»¥è®¾å¤§ä¸€ç‚¹ï¼ˆ2-3 å€ requestï¼‰
- **Memory Limit**ï¼šè®¾ç½®ä¿å®ˆï¼ˆ1.5-2 å€ requestï¼‰ï¼Œé¿å…é¢‘ç¹ OOM

---

## ğŸ¯ éªŒè¯èµ„æºé…ç½®æ•ˆæœ

### **æ£€æŸ¥è„šæœ¬**

```bash
#!/bin/bash
# resource-check.sh - èµ„æºé…ç½®éªŒè¯è„šæœ¬

NS="wordpress-v2"

echo "=========================================="
echo "WordPress v2.1 èµ„æºé…ç½®éªŒè¯"
echo "=========================================="
echo ""

echo "ğŸ“Š 1. Pod èµ„æºé…ç½®æ‘˜è¦"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
kubectl get pods -n $NS -o custom-columns=\
NAME:.metadata.name,\
QOS:.status.qosClass,\
CPU-REQ:.spec.containers[0].resources.requests.cpu,\
CPU-LIM:.spec.containers[0].resources.limits.cpu,\
MEM-REQ:.spec.containers[0].resources.requests.memory,\
MEM-LIM:.spec.containers[0].resources.limits.memory

echo ""
echo "ğŸ“Š 2. èŠ‚ç‚¹èµ„æºåˆ†é…æƒ…å†µ"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
kubectl describe node k8s-master | grep -A 15 "Allocated resources"

echo ""
echo "ğŸ“Š 3. Namespace èµ„æºé…é¢ï¼ˆå¦‚æœé…ç½®äº† ResourceQuotaï¼‰"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
kubectl get resourcequota -n $NS 2>/dev/null || echo "æœªé…ç½® ResourceQuota"

echo ""
echo "âœ… éªŒè¯å®Œæˆï¼"
```

**è¿è¡Œæ£€æŸ¥**ï¼š
```bash
chmod +x resource-check.sh
./resource-check.sh
```

---

## ğŸ“š å­¦ä¹ æ€»ç»“ï¼ˆé˜¶æ®µ 2ï¼‰

### **ä½ å·²ç»æŒæ¡**ï¼š

1. âœ… **Requestsï¼ˆè¯·æ±‚ï¼‰**ï¼š
    - è°ƒåº¦ä¿è¯ï¼ŒèŠ‚ç‚¹å¿…é¡»æœ‰è¶³å¤Ÿèµ„æº
    - å†³å®š Pod å¯ä»¥è¢«è°ƒåº¦åˆ°å“ªä¸ªèŠ‚ç‚¹

2. âœ… **Limitsï¼ˆé™åˆ¶ï¼‰**ï¼š
    - è¿è¡Œæ—¶å¼ºåˆ¶ï¼Œå®¹å™¨ä¸èƒ½è¶…å‡º
    - CPU è¶…é™ â†’ é™æµï¼ˆæ€§èƒ½ä¸‹é™ï¼‰
    - Memory è¶…é™ â†’ OOMKilledï¼ˆPod é‡å¯ï¼‰

3. âœ… **QoS ç­‰çº§**ï¼š
    - **Guaranteed**ï¼šrequests = limitsï¼Œæœ€é«˜ä¼˜å…ˆçº§
    - **Burstable**ï¼šæœ‰ requests/limits ä½†ä¸ç›¸ç­‰ï¼Œä¸­ç­‰ä¼˜å…ˆçº§
    - **BestEffort**ï¼šæ— ä»»ä½•é…ç½®ï¼Œæœ€ä½ä¼˜å…ˆçº§

4. âœ… **é…ç½®ç­–ç•¥**ï¼š
    - Web åº”ç”¨ï¼š200m/500m CPUï¼Œ256Mi/512Mi Memory
    - æ•°æ®åº“ï¼š500m/1 CPUï¼Œ512Mi/1Gi Memory

---

## ğŸ¯ ä¸‹ä¸€æ­¥

å®Œæˆé˜¶æ®µ 2 éªŒè¯åï¼Œå‘Šè¯‰æˆ‘ç»“æœï¼Œæˆ‘ä»¬ç»§ç»­ï¼š
- **é˜¶æ®µ 3**ï¼šIngress åŸŸåè®¿é—®ï¼ˆä¸ƒå±‚è´Ÿè½½å‡è¡¡ï¼‰
- è¿˜æ˜¯å…ˆæš‚åœï¼Œä½ æƒ³æ·±å…¥å®éªŒèµ„æºç®¡ç†ï¼Ÿ

ä½ çš„é€‰æ‹©ï¼Ÿç»§ç»­å‰è¿›è¿˜æ˜¯æ·±å…¥å®éªŒï¼ŸğŸš€